name: mnist
description: MLCommons MNIST MLCube example
authors:
  - {name: "Sergey Serebryakov", email: "sergey.serebryakov@hpe.com", org: "Hewlett-Packard Labs"}


platform:
  accelerator_count: 1


container:
  image: mlcommons/mnist:0.0.1
  build_context: "mnist"
  build_file: "Dockerfile"
  # The rest of this section is read from user local config (e.g. $HOME/.mlcube.yaml)
  docker: docker
  gpu_args: >-
    --rm  --gpus=all --net=host --uts=host --ipc=host --ulimit stack=67108864 --ulimit memlock=-1
    --privileged=true --security-opt seccomp=unconfined
  env_args:
    http_proxy: "http://web-proxy-pa.labs.hpecorp.net:8088"
    https_proxy: "http://web-proxy-pa.labs.hpecorp.net:8088"
  build_args:
    http_proxy: "http://web-proxy-pa.labs.hpecorp.net:8088"
    https_proxy: "http://web-proxy-pa.labs.hpecorp.net:8088"


tasks:
  download:
    io:
      - {name: data_dir, type: directory, io: output, default: $WORKSPACE/data}
      - {name: log_dir, type: directory, io: output, default: $WORKSPACE/logs/download}
  train:
    io:
      - {name: data_dir, type: directory, io: input, default: $WORKSPACE/data}
      - {name: parameters_file, type: file, io: input, default: $WORKSPACE/parameters/default.parameters.yaml}
      - {name: log_dir, type: directory, io: output, default: $WORKSPACE/logs/train}
      - {name: model_dir, type: directory, io: output, default: $WORKSPACE/model}
